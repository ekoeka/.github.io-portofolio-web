<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Proyek</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <button onclick="document.body.classList.toggle('dark-mode')" class="tombol-floating">üåì Mode</button>
    
    <div class="container-pusat">
        <div style="text-align:left; margin-bottom:20px;">
            <a href="index.html" class="tombol-buka" style="display:inline-block; width:auto;">‚Üê Kembali</a>
        </div>

        <div class="kartu-profile" style="display:block;">
            <div class="layout-golden">
                <div class="area-teks">
                    <div style="border-bottom:1px solid var(--icon-color); padding-bottom:15px; margin-bottom:15px;">
                        <h1 id="judul" style="margin:0; font-size:2.5rem;">Loading...</h1>
                        <span id="tanggal" style="opacity:0.7; font-family:'Space Mono'">...</span>
                        <div id="tags" class="tag-container" style="margin-top:10px;"></div>
                    </div>
                    <div id="deskripsi" style="white-space:pre-wrap; line-height:1.8;">...</div>
                </div>

                <div class="area-visual">
                    <div id="slider-area" class="slider-container" style="display:none;"></div>
                    <img id="single-img" src="" style="width:100%; border-radius:10px; display:none;">
                    
                    <div style="margin-top:20px;">
                        
                        <a id="btn-github" href="#" target="_blank" class="tombol-buka" style="margin-top:10px; display:none;">
                            <i class="fa-brands fa-github"></i> GitHub Repo
                        </a>
                        
                        <a id="btn-youtube" href="#" target="_blank" class="tombol-youtube" style="display:none;">
                            <i class="fa-brands fa-youtube"></i> Tonton Demo
                        </a>

                        <a id="btn-jurnal" href="#" target="_blank" class="tombol-jurnal" style="display:none;">
                            <i class="fa-solid fa-book-open"></i> Baca Dokumen
                        </a>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- LINK CSV TAB 1 (PROJECTS) SUDAH DIMASUKKAN DI SINI ---
        const urlProyek = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSc3E3Xzu3FiwgF-f-HBLtafqvZr60_yGffzZFrs4wt_GQZaMym4xVYl9Sil2bA5giQvDaYcvOuimwq/pub?gid=0&single=true&output=csv';

        async function muatDetail() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id'); if(id===null) return;

            try {
                const resp = await fetch(urlProyek); 
                const text = await resp.text();
                // Filter baris kosong agar index akurat
                const rows = text.split('\n').filter(r => r.trim() !== "").slice(1);
                
                const data = rows[id]; 
                if(!data) return;

                const c = data.split(',');

                // --- 1. ISI TEKS ---
                document.getElementById('judul').innerText = c[0];
                document.getElementById('deskripsi').innerText = c[2].replace(/"/g, '');
                document.getElementById('tanggal').innerText = c[5] ? "üìÖ " + c[5] : "";
                
                if(c[6] && c[6].trim() !== "") {
                    let t = ''; c[6].split('|').forEach(tag => t+=`<span class="tag">${tag.trim()}</span>`);
                    document.getElementById('tags').innerHTML = t;
                }

                // --- 2. LOGIKA GAMBAR (Kolom D / Index 3) ---
                const rawImg = c[3];
                const slider = document.getElementById('slider-area');
                const single = document.getElementById('single-img');
                
                if (rawImg && rawImg.trim() !== "") {
                    if(rawImg.includes('|')) {
                        // Slider Logic
                        const list = rawImg.split('|');
                        let html = '';
                        list.forEach((url, i) => html += `<img class="slide-img ${i===0?'active':''}" src="${url.trim()}">`);
                        slider.innerHTML = html;
                        slider.style.display = 'block';
                        
                        let idx = 0;
                        setInterval(() => {
                            const slides = document.querySelectorAll('.slide-img');
                            if(slides.length>0) {
                                slides[idx].classList.remove('active');
                                idx = (idx + 1) % slides.length;
                                slides[idx].classList.add('active');
                            }
                        }, 3000);
                    } else {
                        // Single Image
                        single.src = rawImg.trim();
                        single.style.display = 'block';
                    }
                }

                // --- 3. LOGIKA TOMBOL ---

                // GitHub
                const btnGit = document.getElementById('btn-github');
                if(c[4] && c[4].trim() !== "" && c[4].includes('http')) { 
                    btnGit.href = c[4].trim(); 
                    btnGit.style.display = 'block'; 
                }
                
                // YouTube
                const btnYt = document.getElementById('btn-youtube');
                if(c[7] && c[7].trim() !== "" && (c[7].includes('youtube') || c[7].includes('youtu'))) { 
                    btnYt.href = c[7].trim(); 
                    btnYt.style.display = 'block'; 
                }

                // Jurnal / Tambahan
                const btnJurnal = document.getElementById('btn-jurnal');
                if(c[8] && c[8].trim() !== "" && c[8].includes('http')) {
                    btnJurnal.href = c[8].trim();
                    btnJurnal.style.display = 'block';
                }

            } catch(e) { console.log(e); }
        }
        muatDetail();
    </script>
</body>
</html>